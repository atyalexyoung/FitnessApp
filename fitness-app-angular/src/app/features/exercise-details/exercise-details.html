<main class="exercise-details-page" fxLayout="column" fxLayoutGap="24px">
    <!-- Media Carousel -->
    <div class="media-carousel-container" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event)">

        <!-- Navigation buttons -->
        <button mat-icon-button class="carousel-btn prev-btn" *ngIf="canGoPrevious" (click)="previousMedia()">
            <mat-icon>chevron_left</mat-icon>
        </button>

        <button mat-icon-button class="carousel-btn next-btn" *ngIf="canGoNext" (click)="nextMedia()">
            <mat-icon>chevron_right</mat-icon>
        </button>

        <!-- Media display -->
        <div class="media-wrapper">
            <!-- Image -->
            <img *ngIf="currentMedia?.type === 'image' && mediaLoaded" class="exercise-media" [src]="currentMedia?.url"
                [alt]="exercise?.name" (load)="onMediaLoad()" />

            <!-- Video -->
            <video *ngIf="currentMedia?.type === 'video' && mediaLoaded" class="exercise-media"
                [src]="currentMedia?.url" controls (loadeddata)="onMediaLoad()">
            </video>

            <!-- Loading spinner -->
            <mat-progress-spinner *ngIf="!mediaLoaded && currentMedia" mode="indeterminate" diameter="50">
            </mat-progress-spinner>

            <!-- No media placeholder -->
            <div *ngIf="!currentMedia" class="no-media">
                <mat-icon>image_not_supported</mat-icon>
                <p>No media available</p>
            </div>
        </div>

        <!-- Media counter -->
        <div class="media-counter" *ngIf="mediaItems.length > 0">
            {{ currentMediaIndex + 1 }} / {{ mediaItems.length }}
        </div>

        <!-- Indicator dots -->
        <div class="media-indicators" *ngIf="mediaItems.length > 1">
            <span *ngFor="let item of mediaItems; let i = index" class="indicator-dot"
                [class.active]="i === currentMediaIndex" (click)="currentMediaIndex = i; mediaLoaded = false;">
            </span>
        </div>
    </div>

    <section>
        <h1 matTypography>{{ exercise?.name }}</h1>
    </section>

    <section>
        <h3 matTypography>Description</h3>
        <p>{{ exercise?.description }}</p>
    </section>

    <section>
        <h3 matTypography>Body parts worked</h3>
        <mat-chip-set>
            <mat-chip *ngFor="let part of exercise?.bodyParts">
                {{ part }}
            </mat-chip>
        </mat-chip-set>

        <h3 matTypography>Type(s)</h3>
        <mat-chip-set>
            <mat-chip *ngFor="let tag of exercise?.exerciseTags">
                {{ tag }}
            </mat-chip>
        </mat-chip-set>
    </section>

    <div class="back-button">
        <section>
            <button mat-raised-button color="primary" (click)="goBack()">
                Back
            </button>
        </section>
    </div>
</main>